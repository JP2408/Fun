Option Explicit

Sub Import_Deduped_Data_From_File()
    Dim srcFilePath As String
    Dim wbSrc As Workbook
    Dim wsSrc As Worksheet
    Dim wbDest As Workbook
    Dim wsDest As Worksheet
    Dim lastRow As Long
    
    ' >>> CHANGE THIS TO YOUR SOURCE FILE FULL PATH <<<
    ' Example: "C:\Users\YourName\Documents\SourceFile.xlsx"
    srcFilePath = "C:\Path\To\Your\File.xlsx"
    
    On Error GoTo ErrHandler
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ' Destination is the workbook where this macro lives
    Set wbDest = ThisWorkbook
    Set wsDest = wbDest.ActiveSheet   ' or specify sheet: Set wsDest = wbDest.Sheets("Sheet1")
    
    ' Open source workbook
    Set wbSrc = Workbooks.Open(Filename:=srcFilePath, ReadOnly:=True)
    ' Use first sheet â€“ change if needed
    Set wsSrc = wbSrc.Worksheets(1)
    
    ' Find last used row in source based on column A
    lastRow = wsSrc.Cells(wsSrc.Rows.Count, "A").End(xlUp).Row
    If lastRow < 2 Then
        MsgBox "No data found in source file.", vbExclamation
        GoTo Cleanup
    End If
    
    ' Remove duplicates based on Column G (7th column)
    ' Assumes FIRST ROW IS HEADER. If no header, change Header:=xlNo
    With wsSrc.Range("A1:P" & lastRow)
        .RemoveDuplicates Columns:=7, Header:=xlYes
    End With
    
    ' Recalculate last row after deduplication
    lastRow = wsSrc.Cells(wsSrc.Rows.Count, "A").End(xlUp).Row
    
    ' Clear destination A:P before pasting
    wsDest.Range("A:P").ClearContents
    
    ' Copy A:P from source to destination
    wsSrc.Range("A1:P" & lastRow).Copy Destination:=wsDest.Range("A1")
    
    MsgBox "Data imported and duplicates removed based on Column G.", vbInformation

Cleanup:
    On Error Resume Next
    If Not wbSrc Is Nothing Then wbSrc.Close SaveChanges:=False
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    Exit Sub

ErrHandler:
    MsgBox "Error: " & Err.Number & " - " & Err.Description, vbCritical
    Resume Cleanup
End Sub
